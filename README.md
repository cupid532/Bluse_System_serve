## ç®¡ç†æ–¹æ¡ˆ
dockgeï¼ˆdocker é¡¹ç›®ç®¡ç†ï¼‰
caddyï¼ˆä¸€é”®åä»£ï¼‰
- - - 
## 1.ç³»ç»Ÿåˆå§‹åŒ–
### 1.1 æ›´æ–°/å®‰è£…è½¯ä»¶åŒ…
```bash
apt update
apt install curl -y
```
### 1.2å®‰è£… Docker
```bash
#!/bin/bash

# =================================================================
# è„šæœ¬åç§°: Docker çŽ¯å¢ƒå…¨è‡ªåŠ¨ä¸¥è°¨åˆå§‹åŒ–å·¥å…·
# é€‚ç”¨ç³»ç»Ÿ: Debian 12 (Bookworm)
# =================================================================

# è®¾ç½®é¢œè‰²å˜é‡
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

# 1. çŽ¯å¢ƒé¢„æ£€
echo -e "${GREEN}ðŸ” æ­£åœ¨è¿›è¡Œç³»ç»ŸçŽ¯å¢ƒæ£€æŸ¥...${NC}"
if [ "$EUID" -ne 0 ]; then 
    echo -e "${RED}é”™è¯¯: è¯·ä½¿ç”¨ root ç”¨æˆ·æˆ– sudo è¿è¡Œæ­¤è„šæœ¬ã€‚${NC}"
    exit 1
fi

OS_CHECK=$(grep "VERSION_ID" /etc/os-release | cut -d '"' -f 2)
if [ "$OS_CHECK" != "12" ]; then
    echo -e "${RED}è­¦å‘Š: æ­¤è„šæœ¬é’ˆå¯¹ Debian 12 ä¼˜åŒ–ï¼Œæ£€æµ‹åˆ°æ‚¨çš„ç‰ˆæœ¬ä¸º $OS_CHECKï¼Œå¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚${NC}"
fi

# 2. å®‰è£…æºé€‰æ‹©
echo -e "${GREEN}è¯·é€‰æ‹©å®‰è£…çŽ¯å¢ƒï¼š${NC}"
echo "1) å›½å¤–æœåŠ¡å™¨ (å®˜æ–¹åŽŸç‰ˆæº - é€‚åˆæµ·å¤–æœºåž‹)"
echo "2) å›½å†…æœåŠ¡å™¨ (é˜¿é‡Œäº‘é•œåƒæº - é€‚åˆæ·±åœ³/æ­å·žç­‰å›½å†…æœºåž‹)"
echo "3) è‡ªå®šä¹‰è„šæœ¬åœ°å€"
read -p "è¯·è¾“å…¥æ•°å­— [1/2/3, é»˜è®¤ 1]: " source_choice
source_choice=${source_choice:-1}

# 3. æ¸…ç†æ®‹ç•™
rm -f get-docker.sh

# 4. æ‰§è¡Œå®‰è£…é€»è¾‘
if ! command -v docker &> /dev/null; then
    case $source_choice in
        1)
            echo -e "${GREEN}ðŸš€ æ­£åœ¨é€šè¿‡å®˜æ–¹æºå®‰è£… Docker...${NC}"
            curl -fsSL https://get.docker.com | sh
            ;;
        2)
            echo -e "${GREEN}ðŸš€ æ­£åœ¨é…ç½®å›½å†…é•œåƒç«™å¹¶å®‰è£… (å®Œå…¨ç»•è¿‡å®˜æ–¹åŸŸå)...${NC}"
            apt-get update && apt-get install -y ca-certificates curl gnupg lsb-release
            # é…ç½® GPG å¯†é’¥
            install -m 0755 -d /etc/apt/keyrings
            curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/debian/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg --yes
            # é…ç½®è½¯ä»¶æº
            echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.aliyun.com/docker-ce/linux/debian $(lsb_release -cs) stable" | tee /etc/apt/sources.list.d/docker.list > /dev/null
            apt-get update
            apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
            
            # é…ç½® Docker Hub å›½å†…åŠ é€Ÿå™¨
            echo -e "${GREEN}ðŸ› ï¸ æ­£åœ¨é…ç½®é•œåƒåŠ é€Ÿå™¨...${NC}"
            mkdir -p /etc/docker
            cat > /etc/docker/daemon.json <<EOF
{
  "registry-mirrors": [
    "https://mirror.iscas.ac.cn",
    "https://mirror.baidubce.com",
    "https://docker.m.daocloud.io"
  ]
}
EOF
            ;;
        3)
            read -p "è¯·è¾“å…¥è‡ªå®šä¹‰ URL: " custom_url
            curl -fsSL $custom_url | sh
            ;;
    esac
    
    systemctl enable docker
    systemctl start docker
else
    echo -e "${GREEN}âœ“ æ£€æµ‹åˆ° Docker å·²å®‰è£…ï¼Œè·³è¿‡å®‰è£…æ­¥éª¤ã€‚${NC}"
fi

# 5. åŽŸæœ‰ç›®å½•ä¸Žæƒé™é€»è¾‘ (ä¿æŒä¸¥è°¨æ€§)
echo -e "${GREEN}ðŸŒ é…ç½® Docker ç½‘ç»œ...${NC}"
docker network create proxynet 2>/dev/null || echo "âœ“ ç½‘ç»œå·²å­˜åœ¨"

echo -e "${GREEN}ðŸ“ åˆå§‹åŒ–ç›®å½•ç»“æž„ /data...${NC}"
mkdir -p /data/{stacks,shared/{media,downloads,backups},scripts,logs}

echo -e "${GREEN}ðŸ” é…ç½®æƒé™æ¨¡åž‹ (PUID/PGID: 1000)...${NC}"
chown -R 1000:1000 /data
chmod 750 /data
chmod -R u+rwX,g+rX,o-rwx /data

echo -e "${GREEN}ðŸ“ å†™å…¥çŽ¯å¢ƒé…ç½®æ–‡ä»¶...${NC}"
cat > /data/.env << 'ENVEOF'
# Generated by Setup Script
PUID=1000
PGID=1000
TZ=Asia/Shanghai
ENVEOF

# 6. æœ€ç»ˆä¿¡æ¯å±•ç¤º
echo ""
echo -e "${GREEN}========================================${NC}"
echo -e "${GREEN}âœ… ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸï¼${NC}"
echo -e "Docker ç‰ˆæœ¬: $(docker --version)"
echo -e "å­˜å‚¨ç›®å½•: /data"
echo -e "å¯ç”¨ç©ºé—´: $(df -h /data | tail -1 | awk '{print $4}')"
if [ "$source_choice" == "2" ]; then
    echo -e "é•œåƒåŠ é€Ÿ: å·²å¯ç”¨ (ä¸­ç§‘é™¢/ç™¾åº¦/DaoCloud)"
fi
echo -e "${GREEN}========================================${NC}"
```
---

## ðŸš€ 2. æ ¸å¿ƒæœåŠ¡éƒ¨ç½²

### 2.1 éƒ¨ç½² Dockgeï¼ˆç®¡ç†é¢æ¿ï¼‰

**è®¿é—®åœ°å€**ï¼š`http://<æœåŠ¡å™¨IP>:5001`

```bash
# å¤åˆ¶æ•´æ®µæ‰§è¡Œï¼šéƒ¨ç½² Dockge
mkdir -p /data/stacks/dockge && cd /data/stacks/dockge

cat > compose.yaml << 'EOF'
services:
  dockge:
    image: louislam/dockge:1
    container_name: dockge
    restart: unless-stopped
    ports:
      - "5001:5001"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./data:/app/data
      - /data/stacks:/data/stacks
    environment:
      - DOCKGE_STACKS_DIR=/data/stacks
      - TZ=Asia/Shanghai
    networks:
      - proxynet
    labels:
      - "com.centurylinklabs.watchtower.enable=true"

networks:
  proxynet:
    external: true
EOF

docker compose up -d

echo ""
echo "âœ… Dockge å·²å¯åŠ¨"
echo "ðŸ“ è®¿é—®åœ°å€: http://$(hostname -I | awk '{print $1}'):5001"
echo "ðŸ”‘ é¦–æ¬¡è®¿é—®éœ€è¦è®¾ç½®ç®¡ç†å‘˜è´¦å·"
```

### 2.2 éƒ¨ç½² Caddyï¼ˆåå‘ä»£ç†ç½‘å…³ï¼‰

```bash
# å¤åˆ¶æ•´æ®µæ‰§è¡Œï¼šéƒ¨ç½² Caddy
mkdir -p /data/stacks/caddy && cd /data/stacks/caddy

# åˆ›å»ºåˆå§‹ Caddyfile
cat > Caddyfile << 'EOF'
# Caddy å…¨å±€é…ç½®
{
    email admin@example.com
    admin off
}

# ç¤ºä¾‹ï¼šDockge åå‘ä»£ç†ï¼ˆéœ€è¦é…ç½®åŸŸå DNSï¼‰
# dockge.example.com {
#     reverse_proxy dockge:5001
# }

# å¥åº·æ£€æŸ¥ç«¯ç‚¹
:80 {
    respond /health 200
}
EOF

cat > compose.yaml << 'EOF'
services:
  caddy:
    image: caddy:2-alpine
    container_name: caddy
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
      - "443:443/udp"  # HTTP/3 æ”¯æŒ
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile
      - ./data:/data
      - ./config:/config
      - /data/logs/caddy:/var/log/caddy
    environment:
      - TZ=Asia/Shanghai
    networks:
      - proxynet
    labels:
      - "com.centurylinklabs.watchtower.enable=true"

networks:
  proxynet:
    external: true
EOF

docker compose up -d

echo ""
echo "âœ… Caddy ç½‘å…³å·²å°±ç»ª"
echo "ðŸ“ é…ç½®æ–‡ä»¶: /data/stacks/caddy/Caddyfile"
echo "ðŸ” æµ‹è¯•å‘½ä»¤: curl http://localhost/health"
```

### 2.2.1 Caddyçš„ä¸€é”®è„šæœ¬
```bash
# ä¸€é”®éƒ¨ç½² Caddy ç®¡ç†å¿«æ·å‘½ä»¤
cat > /usr/local/bin/caddy << 'EOF'
#!/bin/bash

# Caddy ç®¡ç†è„šæœ¬
# å·¥ä½œç›®å½•
CADDY_DIR="/data/stacks/caddy"
CADDYFILE="$CADDY_DIR/Caddyfile"

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# æ£€æŸ¥æ˜¯å¦åœ¨æ­£ç¡®çš„ç›®å½•
check_dir() {
    if [ ! -d "$CADDY_DIR" ]; then
        echo -e "${RED}é”™è¯¯: Caddy ç›®å½•ä¸å­˜åœ¨ ($CADDY_DIR)${NC}"
        exit 1
    fi
}

# æ˜¾ç¤ºèœå•
show_menu() {
    clear
    echo -e "${BLUE}========================================${NC}"
    echo -e "${BLUE}       Caddy ç®¡ç†å·¥å…·${NC}"
    echo -e "${BLUE}========================================${NC}"
    echo ""
    echo -e "${GREEN}1.${NC} å¯åŠ¨ Caddy"
    echo -e "${GREEN}2.${NC} å…³é—­ Caddy"
    echo -e "${GREEN}3.${NC} ç¼–è¾‘é…ç½®æ–‡ä»¶"
    echo -e "${GREEN}4.${NC} é‡è½½é…ç½®"
    echo -e "${GREEN}5.${NC} é‡å¯ Caddy"
    echo -e "${GREEN}6.${NC} æŸ¥çœ‹çŠ¶æ€"
    echo -e "${GREEN}7.${NC} æŸ¥çœ‹æ—¥å¿—"
    echo -e "${GREEN}8.${NC} æµ‹è¯•é…ç½®"
    echo -e "${GREEN}0.${NC} é€€å‡º"
    echo ""
    echo -e "${BLUE}========================================${NC}"
}

# å¯åŠ¨ Caddy
start_caddy() {
    echo -e "${YELLOW}æ­£åœ¨å¯åŠ¨ Caddy...${NC}"
    cd $CADDY_DIR
    docker compose up -d
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}âœ… Caddy å¯åŠ¨æˆåŠŸ${NC}"
    else
        echo -e "${RED}âŒ Caddy å¯åŠ¨å¤±è´¥${NC}"
    fi
}

# å…³é—­ Caddy
stop_caddy() {
    echo -e "${YELLOW}æ­£åœ¨å…³é—­ Caddy...${NC}"
    cd $CADDY_DIR
    docker compose down
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}âœ… Caddy å·²å…³é—­${NC}"
    else
        echo -e "${RED}âŒ Caddy å…³é—­å¤±è´¥${NC}"
    fi
}

# ç¼–è¾‘é…ç½®æ–‡ä»¶
edit_config() {
    echo -e "${YELLOW}æ‰“å¼€é…ç½®æ–‡ä»¶ç¼–è¾‘å™¨...${NC}"
    echo -e "${BLUE}é…ç½®æ–‡ä»¶è·¯å¾„: $CADDYFILE${NC}"
    echo ""
    echo -e "${YELLOW}æç¤ºï¼š${NC}"
    
    # ä¼˜å…ˆä½¿ç”¨ nano (æœ€ç®€å•)ï¼Œå…¶æ¬¡ vim, vi
    if command -v nano &> /dev/null; then
        echo -e "${GREEN}ä½¿ç”¨ nano ç¼–è¾‘å™¨ (Ctrl+O ä¿å­˜, Ctrl+X é€€å‡º)${NC}"
        sleep 1
        nano $CADDYFILE
    elif command -v vim &> /dev/null; then
        echo -e "${GREEN}ä½¿ç”¨ vim ç¼–è¾‘å™¨${NC}"
        echo -e "${BLUE}åŸºæœ¬æ“ä½œ: æŒ‰ i è¿›å…¥ç¼–è¾‘æ¨¡å¼, ç¼–è¾‘å®ŒæˆåŽæŒ‰ ESC, ç„¶åŽè¾“å…¥ :wq ä¿å­˜é€€å‡º${NC}"
        sleep 2
        vim $CADDYFILE
    elif command -v vi &> /dev/null; then
        echo -e "${GREEN}ä½¿ç”¨ vi ç¼–è¾‘å™¨${NC}"
        echo -e "${BLUE}åŸºæœ¬æ“ä½œ: æŒ‰ i è¿›å…¥ç¼–è¾‘æ¨¡å¼, ç¼–è¾‘å®ŒæˆåŽæŒ‰ ESC, ç„¶åŽè¾“å…¥ :wq ä¿å­˜é€€å‡º${NC}"
        sleep 2
        vi $CADDYFILE
    elif [ -n "$EDITOR" ]; then
        $EDITOR $CADDYFILE
    else
        echo -e "${RED}âŒ æœªæ‰¾åˆ°å¯ç”¨çš„ç¼–è¾‘å™¨${NC}"
        echo -e "${YELLOW}è¯·å…ˆå®‰è£…ç¼–è¾‘å™¨: apt install nano æˆ– yum install nano${NC}"
        return 1
    fi
    
    # ç¼–è¾‘å®ŒæˆåŽè¯¢é—®æ˜¯å¦é‡è½½
    echo ""
    echo -e "${YELLOW}é…ç½®æ–‡ä»¶å·²ç¼–è¾‘å®Œæˆ${NC}"
    read -p "æ˜¯å¦é‡è½½ Caddy é…ç½®ï¼Ÿ(y/n): " choice
    case "$choice" in 
        y|Y|yes|YES ) reload_caddy;;
        * ) echo -e "${BLUE}å·²å–æ¶ˆé‡è½½${NC}";;
    esac
}

# é‡è½½é…ç½®
reload_caddy() {
    echo -e "${YELLOW}æ­£åœ¨é‡è½½ Caddy é…ç½®...${NC}"
    docker exec caddy caddy reload --config /etc/caddy/Caddyfile
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}âœ… é…ç½®é‡è½½æˆåŠŸ${NC}"
    else
        echo -e "${RED}âŒ é…ç½®é‡è½½å¤±è´¥${NC}"
    fi
}

# é‡å¯ Caddy
restart_caddy() {
    echo -e "${YELLOW}æ­£åœ¨é‡å¯ Caddy...${NC}"
    cd $CADDY_DIR
    docker compose restart
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}âœ… Caddy é‡å¯æˆåŠŸ${NC}"
    else
        echo -e "${RED}âŒ Caddy é‡å¯å¤±è´¥${NC}"
    fi
}

# æŸ¥çœ‹çŠ¶æ€
show_status() {
    echo -e "${BLUE}========== Caddy çŠ¶æ€ ==========${NC}"
    cd $CADDY_DIR
    docker compose ps
    echo ""
    echo -e "${BLUE}========== å®¹å™¨è¯¦æƒ… ==========${NC}"
    docker inspect caddy --format='{{.State.Status}}' 2>/dev/null
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}å®¹å™¨è¿è¡ŒçŠ¶æ€: $(docker inspect caddy --format='{{.State.Status}}')${NC}"
        echo -e "${GREEN}å¯åŠ¨æ—¶é—´: $(docker inspect caddy --format='{{.State.StartedAt}}')${NC}"
    else
        echo -e "${RED}å®¹å™¨æœªè¿è¡Œ${NC}"
    fi
}

# æŸ¥çœ‹æ—¥å¿—
show_logs() {
    echo -e "${YELLOW}æ˜¾ç¤º Caddy æ—¥å¿— (Ctrl+C é€€å‡º)${NC}"
    cd $CADDY_DIR
    docker compose logs -f --tail=50
}

# æµ‹è¯•é…ç½®
test_config() {
    echo -e "${YELLOW}æ­£åœ¨æµ‹è¯• Caddy é…ç½®...${NC}"
    docker exec caddy caddy validate --config /etc/caddy/Caddyfile
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}âœ… é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®${NC}"
    else
        echo -e "${RED}âŒ é…ç½®æ–‡ä»¶æœ‰é”™è¯¯${NC}"
    fi
}

# ä¸»å¾ªçŽ¯
main() {
    check_dir
    
    while true; do
        show_menu
        read -p "è¯·é€‰æ‹©æ“ä½œ [0-8]: " choice
        echo ""
        
        case $choice in
            1) start_caddy ;;
            2) stop_caddy ;;
            3) edit_config ;;
            4) reload_caddy ;;
            5) restart_caddy ;;
            6) show_status ;;
            7) show_logs ;;
            8) test_config ;;
            9) 
                echo -e "${GREEN}é€€å‡º Caddy ç®¡ç†å·¥å…·${NC}"
                exit 0
                ;;
            *)
                echo -e "${RED}æ— æ•ˆçš„é€‰æ‹©ï¼Œè¯·é‡æ–°è¾“å…¥${NC}"
                ;;
        esac
        
        echo ""
        read -p "æŒ‰ Enter é”®ç»§ç»­..." dummy
    done
}

# è¿è¡Œä¸»ç¨‹åº
main
EOF

chmod +x /usr/local/bin/caddy

echo ""
echo "âœ… Caddy ç®¡ç†å‘½ä»¤å·²å®‰è£…å®Œæˆï¼"
echo "ðŸ“ çŽ°åœ¨ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¾“å…¥ 'caddy' æ¥ç®¡ç† Caddy äº†"
echo ""
```

---

## ðŸ¤– 3. AI æç¤ºè¯

### æ ‡å‡†æç¤ºè¯æ¨¡æ¿
```bash
ä½ æ˜¯æˆ‘çš„ç³»ç»Ÿæž¶æž„å¸ˆã€‚è¯·åŸºäºŽ **"Infrastructure as Data"** æž¶æž„è§„èŒƒï¼Œä¸ºæˆ‘ç”Ÿæˆç¬¦åˆç”Ÿäº§çŽ¯å¢ƒæ ‡å‡†çš„ Docker Compose éƒ¨ç½²æ–¹æ¡ˆã€‚

ã€è§’è‰²ç›®æ ‡ã€‘
ç”Ÿæˆä¸€ä»½â€œé›¶æ‘©æ“¦â€çš„éƒ¨ç½²é…ç½®ï¼Œç¡®ä¿æœåŠ¡å¯åŠ¨å³é€šè¿‡ï¼Œæ— éœ€æ‰‹åŠ¨è¿›å…¥å®¹å™¨ä¿®æ”¹é…ç½®ï¼Œä¸”æ–‡ä»¶ç»“æž„æ¸…æ™°ã€æƒé™æ­£ç¡®ã€‚

ã€å¼ºåˆ¶è§„èŒƒã€‘

1. **è¾“å‡ºé¡ºåºæ ‡å‡†ï¼ˆä¸¥æ ¼æ‰§è¡Œï¼‰**
    * **ç¬¬ä¸€æ­¥ (`init.sh`)**ï¼šæ–‡ä»¶ç³»ç»Ÿåˆå§‹åŒ–ã€æƒé™ä¿®æ­£ã€æ ¸å¿ƒé…ç½®é¢„åŸ‹ã€‚
    * **ç¬¬äºŒæ­¥ (`compose.yaml`)**ï¼šå®¹å™¨ç¼–æŽ’å®šä¹‰ã€‚
    * **ç¬¬ä¸‰æ­¥ (`Caddyfile`)**ï¼šåå‘ä»£ç†é…ç½®ã€‚

2. **æŒä¹…åŒ–ç›®å½•æ ‡å‡†**
    * åº”ç”¨é…ç½®ï¼šæŒ‚è½½ `./data`ï¼ˆå½“å‰ compose æ‰€åœ¨ç›®å½•ä¸‹çš„å­ç›®å½•ï¼‰ã€‚
    * åª’ä½“/å¤§æ–‡ä»¶ï¼šæŒ‚è½½ `/data/shared/media`ï¼ˆå…¨å±€å…±äº«ï¼Œåªè¯»å»ºè®®ï¼‰ã€‚
    * æ•°æ®åº“æ–‡ä»¶ï¼šæŒ‚è½½ `./data/db`ã€‚
    * **æƒé™åŽŸåˆ™**ï¼šå¿…é¡»ç¡®ä¿å®¿ä¸»æœºæŒ‚è½½ç›®å½•çš„æƒé™å½’å±žä¸º `PUID:PGID`ã€‚

3. **ç½‘ç»œä¸Žç«¯å£ç­–ç•¥**
    * **æ˜¾å¼æ˜ å°„ç«¯å£**ï¼šå¿…é¡»ä½¿ç”¨ `ports` æš´éœ²ä¸»è¦ç«¯å£ï¼ˆæ ¼å¼ `å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£`ï¼‰ï¼Œä»¥ä¾¿æ”¯æŒç›´è¿žè°ƒè¯•ã€‚
    * **å¤–éƒ¨ç½‘ç»œ**ï¼šå¿…é¡»åŠ å…¥å¤–éƒ¨ç½‘ç»œ `proxynet`ï¼ˆç”¨äºŽ Caddy å†…éƒ¨é€šä¿¡ï¼‰ã€‚
    * **æ•æ„ŸæœåŠ¡æ£€æŸ¥**ï¼šå¦‚æžœæœåŠ¡å±žäºŽæ˜“å—æ”»å‡»æˆ–æœ‰é»˜è®¤è®¿é—®é™åˆ¶çš„ç±»åž‹ï¼ˆå¦‚ qBittorrent, Jupyter, Redisï¼‰ï¼š
        * å¿…é¡»åœ¨ `init.sh` ä¸­é¢„ç”Ÿæˆé…ç½®æ–‡ä»¶ä»¥å…è®¸éž Localhost è®¿é—®ï¼ˆå…³é—­ HostHeaderValidation ç­‰ï¼‰ã€‚
        * æˆ–è€…åœ¨æ³¨é‡Šä¸­æ˜Žç¡®æç¤ºæ˜¯å¦éœ€è¦ä¸ºäº†å®‰å…¨è€Œç§»é™¤ `ports` æ˜ å°„ã€‚

4. **çŽ¯å¢ƒä¸Žå®¹å™¨é…ç½®**
    * **çŽ¯å¢ƒå˜é‡**ï¼š`PUID=1000`, `PGID=1000`, `TZ=Asia/Shanghai`ã€‚
    * **é‡å¯ç­–ç•¥**ï¼š`restart: unless-stopped`ã€‚
    * **æ›´æ–°ç®¡ç†**ï¼šæ·»åŠ  label `com.centurylinklabs.watchtower.enable=true`ã€‚
    * **å®‰å…¨æ€§**ï¼šç¦æ­¢ä½¿ç”¨é»˜è®¤å¯†ç ï¼ˆä½¿ç”¨ `environment` ä¼ é€’å¼ºå¯†ç æˆ–éšæœºç”Ÿæˆï¼‰ï¼Œéžå¿…è¦ä¸ä½¿ç”¨ root è¿è¡Œã€‚

ã€è¾“å‡ºè¦æ±‚ã€‘

**è¯·ä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§åºŸè¯ï¼Œç›´æŽ¥æŒ‰é¡ºåºè¾“å‡ºä»¥ä¸‹ä¸‰ä¸ªä»£ç å—ï¼š**

#### Block 1: `init.sh`
* **åŠŸèƒ½**ï¼šä¸€é”®åˆå§‹åŒ–è„šæœ¬ã€‚
* **å†…å®¹è¦æ±‚**ï¼š
    1.  `mkdir -p` åˆ›å»ºæ‰€æœ‰æŒ‚è½½ç›®å½•ã€‚
    2.  **[å…³é”®] é…ç½®é¢„åŸ‹**ï¼šå¯¹äºŽ qBittorrent ç­‰é»˜è®¤æ‹’ç»å…¬ç½‘ IP è®¿é—®çš„æœåŠ¡ï¼Œ**å¿…é¡»**åœ¨æ­¤å¤„ä½¿ç”¨ `cat > ... <<EOF` é¢„å†™å…¥é…ç½®æ–‡ä»¶ï¼ˆå¦‚å…³é—­ CSRF/HostHeader æ£€æŸ¥ï¼‰ï¼Œç¡®ä¿æœåŠ¡å¯åŠ¨åŽä¸ä¼šæŠ¥ "Unauthorized"ã€‚
    3.  `chown -R 1000:1000` ä¿®æ­£ç›®å½•æƒé™ã€‚
    4.  è¾“å‡º "Initialization complete" æç¤ºã€‚

#### Block 2: `compose.yaml`
* åŒ…å«å®Œæ•´çš„æœåŠ¡å®šä¹‰ï¼Œæ˜¾å¼ç«¯å£æ˜ å°„ï¼Œç½‘ç»œé…ç½®ã€‚

#### Block 3: `Caddyfile`
* æ ¼å¼ï¼š`æœåŠ¡å.example.com { reverse_proxy å®¹å™¨å:å†…éƒ¨ç«¯å£ }`

---

**ã€å½“å‰ä»»åŠ¡ã€‘**

è¯·ä¸ºæˆ‘éƒ¨ç½²ï¼š[åœ¨æ­¤å¤„è¾“å…¥æœåŠ¡åç§°]
```
---


## ðŸŽ¯ å¿«é€Ÿå¼€å§‹æ£€æŸ¥æ¸…å•

- [ ] æ•°æ®ç›˜å·²æŒ‚è½½åˆ° `/data`
- [ ] æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
- [ ] éƒ¨ç½² Dockge ç®¡ç†é¢æ¿
- [ ] éƒ¨ç½² Caddy åå‘ä»£ç†
- [ ] é…ç½®è‡ªåŠ¨å¤‡ä»½
- [ ] æµ‹è¯•æœåŠ¡éƒ¨ç½²
- [ ] é…ç½®åŸŸåè§£æžï¼ˆå¯é€‰ï¼‰
- [ ] å¯ç”¨ HTTPSï¼ˆå¯é€‰ï¼‰

**æ­å–œï¼æ‚¨çš„æœåŠ¡å™¨æž¶æž„å·²å°±ç»ªã€‚** ðŸŽ‰
